<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebCeph - Cephalometric Analysis</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    }
    
    body {
      background-color: #f8f9fa;
      color: #333;
      line-height: 1.6;
    }
    
    header {
      background-color: #383e56;
      color: white;
      padding: 1rem;
      text-align: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    nav {
      background-color: #eaeaea;
      padding: 0.5rem;
      display: flex;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    nav button {
      margin: 0 0.5rem;
      padding: 0.5rem 1rem;
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 4px;
      cursor: pointer;
    }
    
    nav button:hover {
      background-color: #f0f0f0;
    }
    
    nav button.active {
      background-color: #383e56;
      color: white;
    }
    
    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem;
    }
    
    .viewer-container {
      display: flex;
      height: 75vh;
      margin-top: 1rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      background-color: white;
      border-radius: 8px;
      overflow: hidden;
    }
    
    .sidebar {
      width: 250px;
      background-color: #f0f0f0;
      padding: 1rem;
      border-right: 1px solid #ddd;
      overflow-y: auto;
    }
    
    .main-content {
      flex: 1;
      padding: 1rem;
      display: flex;
      flex-direction: column;
    }
    
    .image-area {
      flex: 1;
      background-color: #444;
      position: relative;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .image-area img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    
    .controls {
      padding: 1rem;
      background-color: #f8f8f8;
      border-top: 1px solid #ddd;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .control-group {
      display: flex;
      align-items: center;
    }
    
    .control-group button, 
    .control-group select {
      margin-right: 0.5rem;
      padding: 0.25rem 0.5rem;
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    
    h2 {
      margin-bottom: 1rem;
      color: #383e56;
    }
    
    .section {
      margin-bottom: 1.5rem;
    }
    
    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
    }
    
    .slider-container {
      display: flex;
      align-items: center;
    }
    
    .slider {
      flex: 1;
      margin-right: 0.5rem;
    }
    
    .value {
      width: 40px;
      text-align: center;
    }
    
    button {
      cursor: pointer;
    }
    
    button:hover {
      opacity: 0.9;
    }
    
    .landmark-list {
      margin-top: 0.5rem;
      max-height: 300px;
      overflow-y: auto;
      border: 1px solid #ddd;
      border-radius: 4px;
      background-color: white;
    }
    
    .landmark-item {
      padding: 0.5rem;
      border-bottom: 1px solid #eee;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .landmark-item:hover {
      background-color: #f5f5f5;
    }
    
    .landmark-item.selected {
      background-color: #e6f7ff;
    }
    
    .landmark-info {
      padding: 1rem;
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-top: 1rem;
    }
    
    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    
    .measurements {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: rgba(255, 255, 255, 0.8);
      padding: 0.5rem;
      border-radius: 4px;
      max-width: 200px;
      max-height: 300px;
      overflow-y: auto;
      font-size: 0.8rem;
    }
    
    .welcome-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 2rem;
    }
    
    .welcome-screen h1 {
      margin-bottom: 1rem;
      font-size: 2.5rem;
      color: #383e56;
    }
    
    .welcome-screen p {
      margin-bottom: 2rem;
      max-width: 600px;
      color: #666;
    }
    
    .welcome-screen button {
      padding: 0.5rem 1.5rem;
      background-color: #383e56;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 1rem;
      cursor: pointer;
    }
    
    .welcome-screen button:hover {
      background-color: #2d3142;
    }
    
    .loading-indicator {
      text-align: center;
      padding: 2rem;
      color: #666;
    }
    
    .error-message {
      background-color: #fff3f3;
      border: 1px solid #ff9999;
      color: #cc0000;
      padding: 1rem;
      border-radius: 4px;
      margin: 1rem 0;
    }
    
    @media (max-width: 768px) {
      .viewer-container {
        flex-direction: column;
        height: auto;
      }
      
      .sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid #ddd;
      }
      
      .main-content {
        height: 50vh;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>WebCeph</h1>
    <p>Advanced Cephalometric Analysis</p>
  </header>
  
  <nav>
    <button class="active" data-page="home">Home</button>
    <button data-page="analysis">Analysis</button>
    <button data-page="comparison">Comparison</button>
  </nav>
  
  <main id="app">
    <div id="home-page" class="page">
      <div class="welcome-screen">
        <h1>Welcome to WebCeph</h1>
        <p>A cutting-edge cephalometric analysis application that leverages advanced medical imaging technologies to provide intuitive, intelligent diagnostic insights for medical professionals.</p>
        <button id="start-demo">Start Demo Analysis</button>
      </div>
    </div>
    
    <div id="analysis-page" class="page" style="display: none;">
      <div class="viewer-container">
        <div class="sidebar">
          <div class="section">
            <h2>Patient Information</h2>
            <p><strong>Name:</strong> John Doe</p>
            <p><strong>Age:</strong> 32</p>
            <p><strong>Gender:</strong> Male</p>
            <p><strong>Date:</strong> 2025-03-13</p>
          </div>
          
          <div class="section">
            <h2>Layer Controls</h2>
            <div>
              <label for="tracing-opacity">Tracing Opacity</label>
              <div class="slider-container">
                <input id="tracing-opacity" class="slider" type="range" min="0" max="100" value="100">
                <span class="value">100%</span>
              </div>
            </div>
            
            <div>
              <label for="landmarks-opacity">Landmarks Opacity</label>
              <div class="slider-container">
                <input id="landmarks-opacity" class="slider" type="range" min="0" max="100" value="100">
                <span class="value">100%</span>
              </div>
            </div>
            
            <div>
              <label for="measurements-opacity">Measurements Opacity</label>
              <div class="slider-container">
                <input id="measurements-opacity" class="slider" type="range" min="0" max="100" value="100">
                <span class="value">100%</span>
              </div>
            </div>
          </div>
          
          <div class="section">
            <h2>Image Settings</h2>
            <div>
              <label for="brightness">Brightness</label>
              <div class="slider-container">
                <input id="brightness" class="slider" type="range" min="0" max="200" value="100">
                <span class="value">100%</span>
              </div>
            </div>
            
            <div>
              <label for="contrast">Contrast</label>
              <div class="slider-container">
                <input id="contrast" class="slider" type="range" min="0" max="200" value="100">
                <span class="value">100%</span>
              </div>
            </div>
          </div>
          
          <div class="section">
            <h2>Landmarks</h2>
            <button id="toggle-edit-mode">Enable Edit Mode</button>
            <div class="landmark-list">
              <div class="landmark-item">
                <span>Nasion (N)</span>
                <span>✓</span>
              </div>
              <div class="landmark-item">
                <span>Sella (S)</span>
                <span>✓</span>
              </div>
              <div class="landmark-item">
                <span>Porion (Po)</span>
                <span>✓</span>
              </div>
              <div class="landmark-item">
                <span>Orbitale (Or)</span>
                <span>✓</span>
              </div>
              <div class="landmark-item">
                <span>A Point (A)</span>
                <span>✓</span>
              </div>
              <div class="landmark-item">
                <span>B Point (B)</span>
                <span>✓</span>
              </div>
              <div class="landmark-item">
                <span>Pogonion (Pog)</span>
                <span>✓</span>
              </div>
              <div class="landmark-item">
                <span>Menton (Me)</span>
                <span>✓</span>
              </div>
              <div class="landmark-item">
                <span>Gonion (Go)</span>
                <span>✓</span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="main-content">
          <div class="image-area">
            <img src="/images/webceph-1.png" alt="Cephalometric X-ray">
            <div class="overlay" id="landmarks-overlay"></div>
            <div class="overlay" id="tracing-overlay"></div>
            <div class="overlay" id="measurements-overlay"></div>
            <div class="measurements">
              <h3>Measurements</h3>
              <p>SNA: 82.3°</p>
              <p>SNB: 79.1°</p>
              <p>ANB: 3.2°</p>
              <p>FMA: 25.5°</p>
              <p>IMPA: 93.7°</p>
            </div>
          </div>
          
          <div class="controls">
            <div class="control-group">
              <button id="zoom-in">Zoom In</button>
              <button id="zoom-out">Zoom Out</button>
              <button id="reset-view">Reset View</button>
            </div>
            
            <div class="control-group">
              <select id="analysis-type">
                <option value="steiner">Steiner Analysis</option>
                <option value="ricketts">Ricketts Analysis</option>
                <option value="tweed">Tweed Analysis</option>
                <option value="downs">Downs Analysis</option>
              </select>
              <button id="generate-report">Generate Report</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div id="comparison-page" class="page" style="display: none;">
      <div class="viewer-container">
        <div class="sidebar">
          <div class="section">
            <h2>Comparison Settings</h2>
            <div>
              <label for="comparison-mode">Mode</label>
              <select id="comparison-mode">
                <option value="sideBySide">Side by Side</option>
                <option value="overlay">Overlay</option>
              </select>
            </div>
            
            <div class="section">
              <h2>Images</h2>
              <div class="landmark-list">
                <div class="landmark-item">
                  <span>Pre-treatment (2023-05-10)</span>
                  <input type="checkbox" checked>
                </div>
                <div class="landmark-item">
                  <span>Mid-treatment (2024-01-15)</span>
                  <input type="checkbox" checked>
                </div>
                <div class="landmark-item">
                  <span>Current (2025-03-13)</span>
                  <input type="checkbox" checked>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="main-content">
          <div class="image-area">
            <div style="display: flex; width: 100%; height: 100%;">
              <div style="flex: 1; border-right: 1px solid #666; display: flex; justify-content: center; align-items: center;">
                <img src="/images/webceph-1.png" alt="Pre-treatment" style="max-width: 100%; max-height: 100%; object-fit: contain;">
              </div>
              <div style="flex: 1; display: flex; justify-content: center; align-items: center;">
                <img src="/images/webceph-1.png" alt="Current" style="max-width: 100%; max-height: 100%; object-fit: contain;">
              </div>
            </div>
          </div>
          
          <div class="controls">
            <div class="control-group">
              <button id="zoom-in-comparison">Zoom In</button>
              <button id="zoom-out-comparison">Zoom Out</button>
              <button id="reset-view-comparison">Reset View</button>
            </div>
            
            <div class="control-group">
              <button id="export-comparison">Export Comparison</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Simple page navigation
    document.querySelectorAll('nav button').forEach(button => {
      button.addEventListener('click', () => {
        // Update active button
        document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        
        // Show the corresponding page
        const pageId = button.getAttribute('data-page');
        document.querySelectorAll('.page').forEach(page => {
          page.style.display = 'none';
        });
        document.getElementById(`${pageId}-page`).style.display = 'block';
      });
    });
    
    // Start demo button
    document.getElementById('start-demo').addEventListener('click', () => {
      document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active'));
      document.querySelector('nav button[data-page="analysis"]').classList.add('active');
      
      document.querySelectorAll('.page').forEach(page => {
        page.style.display = 'none';
      });
      document.getElementById('analysis-page').style.display = 'block';
    });
    
    // Update slider value displays
    document.querySelectorAll('.slider').forEach(slider => {
      const valueDisplay = slider.parentElement.querySelector('.value');
      
      slider.addEventListener('input', () => {
        valueDisplay.textContent = `${slider.value}%`;
      });
    });
    
    // Toggle edit mode
    let editModeEnabled = false;
    const toggleEditModeButton = document.getElementById('toggle-edit-mode');
    
    toggleEditModeButton.addEventListener('click', () => {
      editModeEnabled = !editModeEnabled;
      
      if (editModeEnabled) {
        toggleEditModeButton.textContent = 'Disable Edit Mode';
        toggleEditModeButton.style.backgroundColor = '#3e8e41';
        toggleEditModeButton.style.color = 'white';
      } else {
        toggleEditModeButton.textContent = 'Enable Edit Mode';
        toggleEditModeButton.style.backgroundColor = '';
        toggleEditModeButton.style.color = '';
      }
    });
    
    // Select landmark item
    document.querySelectorAll('.landmark-item').forEach(item => {
      item.addEventListener('click', () => {
        document.querySelectorAll('.landmark-item').forEach(i => i.classList.remove('selected'));
        item.classList.add('selected');
      });
    });
    
    // Simulate zoom controls
    let zoomLevel = 1;
    const zoomStep = 0.1;
    const imageElement = document.querySelector('.image-area img');
    
    document.getElementById('zoom-in').addEventListener('click', () => {
      zoomLevel = Math.min(zoomLevel + zoomStep, 2);
      updateZoom();
    });
    
    document.getElementById('zoom-out').addEventListener('click', () => {
      zoomLevel = Math.max(zoomLevel - zoomStep, 0.5);
      updateZoom();
    });
    
    document.getElementById('reset-view').addEventListener('click', () => {
      zoomLevel = 1;
      updateZoom();
    });
    
    function updateZoom() {
      imageElement.style.transform = `scale(${zoomLevel})`;
    }
    
    // Health check
    fetch('/api/health')
      .then(response => response.json())
      .then(data => {
        console.log('Server status:', data);
      })
      .catch(error => {
        console.error('Error checking server status:', error);
      });
      
    // Check if any parameters exist in URL
    const urlParams = new URLSearchParams(window.location.search);
    const page = urlParams.get('page');
    
    if (page) {
      const pageButton = document.querySelector(`nav button[data-page="${page}"]`);
      if (pageButton) {
        pageButton.click();
      }
    }
  </script>
</body>
</html>